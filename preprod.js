function A(a){return g.getUniformLocation(Program,a)}function B(a,b){return g.uniform1f(A(a),b)}const Program=g.createProgram();let r=0,t=0,j=g.FRAGMENT_SHADER,start=(Date.now()/1000).toFixed(2),n=function(e){const s=g.createShader(j++);g.shaderSource(s,e);g.compileShader(s);g.attachShader(Program,s)};n('precision mediump float;uniform float G,D;uniform vec2 R;vec3 A(vec3 a,float b){float c=cos(b),s=sin(b),x=a.x,y=a.y;return vec3(c*x+s*y,c*y-s*x,a.z);}float B(float a,float r,float b){return min(a,max(a*clamp(b,0.,1.),a-max(r,0.)));}float C(vec3 a,out vec4 b){float i=a.z,g=G,n=.6,m=.5,e=0.;a+=vec3(2.*sin(i*.2+2.*g),sin(i*.1+g),e);b.w=-1.;b.xyz=a;vec3 q,o;o.xy=mod(a.xy,6.)-2.;o.z=mod(i,.05)-n;o=A(o,g+40.*o.z);i=B(length(max(abs(o)-vec3(n,n,n),e)-.01),n,.3);e=B(-(length(a.xy)-4.)+m*sin(atan(b.y,b.x)*6.)*sin(b.z),e,e);if(i<e){b.xyz=o;e=i;};o=a;o.z+=g*13.;i=1.;g=1.5;m=cos(sin(n=floor(o.z/g+m)))*m+i*3.;q=o-vec3(i-.6*sin(m),.4*sin(m*12.+i)+i*i,g*n);g=.08;n=mod(m,2.)>.5?length(max(abs(A(q,m))-vec3(.1*i)+.1,-g))-.1:length(q)-sin(g)*atan(g);if(n<e){b.xyz=q;b.w=3.;e=n;};o.z+=.5;return e;}void Program(out vec4 b,vec2 r){float g=G,n=sin(g),t=g*.4,i=0.;vec3 p=vec3(i,i,g*6.),a=vec3(.1*cos(g),.1*n,cos(t)),e;vec4 m,q;mat3 o;o[1]=cross(o[2]=normalize(a),o[0]=normalize(cross(A(vec3(i,1.,i),3.14*n*sin(t)),a)));e=o*normalize(vec3((2.*r.xy-R.xy)/R.y,2.));for(int j=0;j<40;++j){float v=C(p,q);n+=v;if(v<.01||n>40.){break;};p+=v*e;++i;};r=vec2(.1,0.);a=reflect(e,normalize(vec3(C(p+r.xyy,m)-C(p-r.xyy,m),C(p+r.yxy,m)-C(p-r.yxy,m),C(p+r.yyx,m)-C(p-r.yyx,m))));e=vec3((p.z+g)*.1,q.w<0.?(.2+.8)*.4*sin(q.x*8.)*sin(q.y*10.)*sin(q.z*10.)+.82:1.,1.);p=normalize(vec3(.5,.1,-2.));e=pow(((.82+max(0.,dot(a,p)))*e.z*(1.+.5*e.y*(cos(6.2*(e.x+vec3(.0,.6,.3)))-1.))+pow(max(0.,dot(a,p)),4.))*pow(1.-n/40.,4.)*max(1.,10.*sin(p.z*.1-t)-7.),vec3(.4));e.r=mix(e.r,i/40.,0.);b=vec4(e,1.);}void main(){Program(gl_FragColor,gl_FragCoord.xy);gl_FragColor.w=1.;}');n(['attribute vec4 p;void main(){gl_Position=p;}']);n=g.ELEMENT_ARRAY_BUFFER_BINDING-3;g.enableVertexAttribArray(g.bindBuffer(n,g.createBuffer()));g.linkProgram(Program);g.vertexAttribPointer(Program,2,5120,g.bufferData(n,Int8Array.of(1,n,1,1),n+82),true,0);g.useProgram(Program);(n=function(){const i=(Date.now()/1000).toFixed(2),j=i-start,o=a;let f=B;f('D',start=i);f('G',t+=j);g.drawArrays(6,f('drawArrays',r++),3);g.uniform2f(A('R'),o.width,o.height);requestAnimationFrame(n);})();